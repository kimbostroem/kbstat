```{r}
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
```
Fit model
```{r}
mdl1b <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1b)$coefficients
```
Perform type-2 anova
```{r}
Anova(mdl1b,type=2)
```
Perform type-3 anova
```{r}
Anova(mdl1b,type=3)
```
More complex model (more random factors)
```{r}
formula = 'Anticipation ~ 1 + Expertise*Agency*Visibility + (1|Subject) + (1|Subject:Agency) + (1|Subject:Visibility)'
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl2 <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl2)$coefficients
```
Perform type-3 anova
```{r}
Anova(mdl2,type=3)
```
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
data <- read_excel("Anticipation.xlsx")
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
data <- read_excel("Anticipation.xlsx")
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
suppressMessages(library(wants))
wants
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
suppressMessages(library(wants[has]))
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for package in wants {
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (package in wants) {
suppressMessages(library(package))
}
package
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (package in wants) {
suppressMessages(library(print(package))
}
print(package)
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (package in wants) {
suppressMessages(library(print(package)))
}
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
require(x)
lapply(x, require)
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
require(wants)
lapply(wants, require)
do.call("require", wants)
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
require(wants)
lapply(wants, require)
data <- read_excel("Anticipation.xlsx")
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (package in wants) {
suppressMessages(library(package,character.only=TRUE,quietly=TRUE,verbose=FALSE))
}
data <- read_excel("Anticipation.xlsx")
data$Subject <- as.factor(data$Subject)
data$Expertise <- as.factor(data$Expertise)
data$Agency <- as.factor(data$Agency)
data$Visibility <- as.factor(data$Visibility)
data$Anticipation <- as.numeric(data$Anticipation)
library(car)
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (package in wants) {
suppressMessages(library(package,character.only=TRUE,quietly=TRUE,verbose=FALSE))
}
data <- read_excel("Anticipation.xlsx")
data$Subject <- as.factor(data$Subject)
data$Expertise <- as.factor(data$Expertise)
data$Agency <- as.factor(data$Agency)
data$Visibility <- as.factor(data$Visibility)
data$Anticipation <- as.numeric(data$Anticipation)
library(car)
options(contrasts = c("contr.treatment","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
formula = 'Anticipation ~ 1 + Expertise*Agency*Visibility + (1|Subject)'
mdl1a <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1a)$coefficients
Anova(mdl1a,type=2)
Anova(mdl1a,type=3)
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl1b <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1b)$coefficients
Anova(mdl1b,type=2)
Anova(mdl1b,type=3)
formula = 'Anticipation ~ 1 + Expertise*Agency*Visibility + (1|Subject) + (1|Subject:Agency) + (1|Subject:Visibility)'
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl2 <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl2)$coefficients
for (pkg in wants) {
try(detach(package:pkg))
}
---
title: "Anticipation"
output: html_notebook
---
Initialize code
```{r}
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (pkg in wants) {
suppressMessages(library(pkg,character.only=TRUE,quietly=TRUE,verbose=FALSE))
}
data <- read_excel("Anticipation.xlsx")
data$Subject <- as.factor(data$Subject)
data$Expertise <- as.factor(data$Expertise)
data$Agency <- as.factor(data$Agency)
data$Visibility <- as.factor(data$Visibility)
data$Anticipation <- as.numeric(data$Anticipation)
library(car)
```
Define coding
```{r}
options(contrasts = c("contr.treatment","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
```
Fit model
```{r}
formula = 'Anticipation ~ Expertise*Agency*Visibility + (1|Subject)'
mdl1a <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1a)$coefficients
```
Perform type-2 anova
```{r}
Anova(mdl1a,type=2)
```
Perform type-3 anova
```{r}
Anova(mdl1a,type=3)
```
Change coding
```{r}
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
```
Fit model
```{r}
mdl1b <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1b)$coefficients
```
Perform type-2 anova
```{r}
Anova(mdl1b,type=2)
```
Perform type-3 anova
```{r}
Anova(mdl1b,type=3)
```
More complex model (more random factors)
```{r}
formula = 'Anticipation ~ Expertise*Agency*Visibility + (1|Subject) + (1|Subject:Agency) + (1|Subject:Visibility)'
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl)$coefficients
```
Perform type-3 anova
```{r}
Anova(mdl,type=3)
```
Post-hoc
```{r}
results_posthoc <- emmeans(mdl, ~ Expertise*Agency*Visibility, adjust="holm")
display_posthoc <- data.frame(pairs(results_posthoc))
colnames(display_posthoc)[colnames(display_posthoc)=="t.ratio"] <- "t"
colnames(display_posthoc)[colnames(display_posthoc)=="p.value"] <- "p"
```
<!-- Detach packages -->
<!-- ```{r} -->
<!-- for (pkg in wants) { -->
<!--   try(detach(package:pkg)) -->
<!-- } -->
<!-- ``` -->
results_posthoc <- emmeans(mdl, ~ Expertise*Agency*Visibility, adjust="holm")
display_posthoc <- data.frame(pairs(results_posthoc))
colnames(display_posthoc)[colnames(display_posthoc)=="t.ratio"] <- "t"
colnames(display_posthoc)[colnames(display_posthoc)=="p.value"] <- "p"
results_posthoc <- emmeans(mdl, ~ Expertise*Agency*Visibility, adjust="holm")
display_posthoc <- data.frame(pairs(results_posthoc))
colnames(display_posthoc)[colnames(display_posthoc)=="t.ratio"] <- "t"
colnames(display_posthoc)[colnames(display_posthoc)=="p.value"] <- "p"
write_xlsx(display_posthoc, "Posthoc_lmer.xlsx")
results_posthoc <- emmeans(mdl, ~ Expertise*Agency*Visibility, adjust="tukey")
display_posthoc <- data.frame(pairs(results_posthoc))
colnames(display_posthoc)[colnames(display_posthoc)=="t.ratio"] <- "t"
colnames(display_posthoc)[colnames(display_posthoc)=="p.value"] <- "p"
write_xlsx(display_posthoc, "Posthoc_lmer.xlsx")
results_posthoc <- emmeans(mdl, ~ Expertise*Agency*Visibility, adjust="tukey")
display_posthoc <- data.frame(pairs(results_posthoc))
colnames(display_posthoc)[colnames(display_posthoc)=="t.ratio"] <- "t"
colnames(display_posthoc)[colnames(display_posthoc)=="p.value"] <- "p"
write_xlsx(display_posthoc, "Posthoc_lmer.xlsx")
display(display_posthoc)
summary(display_posthoc)
---
title: "Anticipation"
output: html_notebook
---
Initialize code
```{r}
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (pkg in wants) {
suppressMessages(library(pkg,character.only=TRUE,quietly=TRUE,verbose=FALSE))
}
data <- read_excel("Anticipation.xlsx")
data$Subject <- as.factor(data$Subject)
data$Expertise <- as.factor(data$Expertise)
data$Agency <- as.factor(data$Agency)
data$Visibility <- as.factor(data$Visibility)
data$Anticipation <- as.numeric(data$Anticipation)
library(car)
```
Define coding
```{r}
options(contrasts = c("contr.treatment","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
```
Fit model
```{r}
formula = 'Anticipation ~ Expertise*Agency*Visibility + (1|Subject)'
mdl1a <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1a)$coefficients
```
Perform type-2 anova
```{r}
Anova(mdl1a,type=2)
```
Perform type-3 anova
```{r}
Anova(mdl1a,type=3)
```
Change coding
```{r}
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
```
Fit model
```{r}
mdl1b <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1b)$coefficients
```
Perform type-2 anova
```{r}
Anova(mdl1b,type=2)
```
Perform type-3 anova
```{r}
Anova(mdl1b,type=3)
```
More complex model (more random factors)
```{r}
formula = 'Anticipation ~ Expertise*Agency*Visibility + (1|Subject) + (1|Subject:Agency) + (1|Subject:Visibility)'
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl)$coefficients
```
Perform type-3 anova
```{r}
Anova(mdl,type=3)
```
Post-hoc
```{r}
results_posthoc <- emmeans(mdl, ~ Expertise*Agency*Visibility, adjust="tukey")
display_posthoc <- data.frame(pairs(results_posthoc))
colnames(display_posthoc)[colnames(display_posthoc)=="t.ratio"] <- "t"
colnames(display_posthoc)[colnames(display_posthoc)=="p.value"] <- "p"
write_xlsx(display_posthoc, "Posthoc_lmer.xlsx")
summary(display_posthoc)
```
<!-- Detach packages -->
<!-- ```{r} -->
<!-- for (pkg in wants) { -->
<!--   try(detach(package:pkg)) -->
<!-- } -->
<!-- ``` -->
---
title: "Anticipation"
output: html_notebook
---
Initialize code
```{r}
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (pkg in wants) {
suppressMessages(library(pkg,character.only=TRUE,quietly=TRUE,verbose=FALSE))
}
data <- read_excel("Anticipation.xlsx")
data$Subject <- as.factor(data$Subject)
data$Expertise <- as.factor(data$Expertise)
data$Agency <- as.factor(data$Agency)
data$Visibility <- as.factor(data$Visibility)
data$Anticipation <- as.numeric(data$Anticipation)
library(car)
```
Define coding
```{r}
options(contrasts = c("contr.treatment","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
```
Fit model
```{r}
formula = 'Anticipation ~ Expertise*Agency*Visibility + (1|Subject)'
mdl1a <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1a)$coefficients
```
Perform type-2 anova
```{r}
Anova(mdl1a,type=2)
```
Perform type-3 anova
```{r}
Anova(mdl1a,type=3)
```
Change coding
```{r}
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
```
Fit model
```{r}
mdl1b <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1b)$coefficients
```
Perform type-2 anova
```{r}
Anova(mdl1b,type=2)
```
Perform type-3 anova
```{r}
Anova(mdl1b,type=3)
```
More complex model (more random factors)
```{r}
formula = 'Anticipation ~ Expertise*Agency*Visibility + (1|Subject) + (1|Subject:Agency) + (1|Subject:Visibility)'
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl)$coefficients
```
Perform type-3 anova
```{r}
Anova(mdl,type=3)
```
Post-hoc
```{r}
results_posthoc <- emmeans(mdl, ~ Expertise*Agency*Visibility, adjust="tukey")
display_posthoc <- data.frame(pairs(results_posthoc))
colnames(display_posthoc)[colnames(display_posthoc)=="t.ratio"] <- "t"
colnames(display_posthoc)[colnames(display_posthoc)=="p.value"] <- "p"
write_xlsx(display_posthoc, "Posthoc_lmer.xlsx")
summary(display_posthoc)
```
<!-- Detach packages -->
<!-- ```{r} -->
<!-- for (pkg in wants) { -->
<!--   try(detach(package:pkg)) -->
<!-- } -->
<!-- ``` -->
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (pkg in wants) {
suppressMessages(library(pkg,character.only=TRUE,quietly=TRUE,verbose=FALSE))
}
data <- read_excel("Anticipation.xlsx")
data$Subject <- as.factor(data$Subject)
data$Expertise <- as.factor(data$Expertise)
data$Agency <- as.factor(data$Agency)
data$Visibility <- as.factor(data$Visibility)
data$Anticipation <- as.numeric(data$Anticipation)
library(car)
options(contrasts = c("contr.treatment","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
formula = 'Anticipation ~ Expertise*Agency*Visibility + (1|Subject)'
mdl1a <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1a)$coefficients
Anova(mdl1a,type=2)
Anova(mdl1a,type=3)
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl1b <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1b)$coefficients
Anova(mdl1b,type=2)
Anova(mdl1b,type=3)
formula = 'Anticipation ~ Expertise*Agency*Visibility + (1|Subject) + (1|Subject:Agency) + (1|Subject:Visibility)'
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl)$coefficients
Anova(mdl,type=3)
results_posthoc <- emmeans(mdl, ~ Expertise*Agency*Visibility, adjust="tukey")
display_posthoc <- data.frame(pairs(results_posthoc))
colnames(display_posthoc)[colnames(display_posthoc)=="t.ratio"] <- "t"
colnames(display_posthoc)[colnames(display_posthoc)=="p.value"] <- "p"
write_xlsx(display_posthoc, "Posthoc_lmer.xlsx")
summary(display_posthoc)
wants <- c("readxl","writexl","lmerTest","car","pbkrtest","emmeans","MuMIn","R.matlab")
has <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
for (pkg in wants) {
suppressMessages(library(pkg,character.only=TRUE,quietly=TRUE,verbose=FALSE))
}
data <- read_excel("Anticipation.xlsx")
data$Subject <- as.factor(data$Subject)
data$Expertise <- as.factor(data$Expertise)
data$Agency <- as.factor(data$Agency)
data$Visibility <- as.factor(data$Visibility)
data$Anticipation <- as.numeric(data$Anticipation)
library(car)
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl1 <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl1)$coefficients
Anova(mdl1,type=2)
Anova(mdl1,type=3)
formula = 'Anticipation ~ Expertise*Agency*Visibility + (1|Subject) + (1|Subject:Agency) + (1|Subject:Visibility)'
options(contrasts = c("contr.sum","contr.poly"))
contrasts(data$Expertise)
contrasts(data$Agency)
contrasts(data$Visibility)
mdl <- lmer(formula = formula, data=data, na.action=na.omit, REML=F)
summary(mdl)$coefficients
Anova(mdl,type=3)
results_posthoc <- emmeans(mdl, ~ Expertise*Agency*Visibility, adjust="tukey")
display_posthoc <- data.frame(pairs(results_posthoc))
colnames(display_posthoc)[colnames(display_posthoc)=="t.ratio"] <- "t"
colnames(display_posthoc)[colnames(display_posthoc)=="p.value"] <- "p"
write_xlsx(display_posthoc, "Posthoc_lmer.xlsx")
summary(display_posthoc)
